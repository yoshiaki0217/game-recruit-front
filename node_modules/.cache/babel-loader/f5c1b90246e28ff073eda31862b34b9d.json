{"ast":null,"code":"import _taggedTemplateLiteral from \"/usr/src/app/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral.js\";\nimport _defineProperty from \"/usr/src/app/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";\nimport _objectSpread from \"/usr/src/app/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport _slicedToArray from \"/usr/src/app/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\n\nvar _jsxFileName = \"/usr/src/app/src/pages/Register.jsx\",\n    _this = this,\n    _s = $RefreshSig$(),\n    _templateObject,\n    _templateObject2,\n    _templateObject3;\n\nimport { useState } from 'react';\nimport { useHistory } from 'react-router-dom';\nimport styled from 'styled-components';\nimport axios from 'axios';\nimport { InputText, InputButton } from '../components/index';\nimport Ninja from \"../images/ninja.svg\";\nimport Key from \"../images/key.svg\";\nimport { Link } from 'react-router-dom';\nimport Left from \"../images/left-arrow.svg\";\nimport Joi from 'joi-browser';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nvar schema = Joi.object({\n  user_name: Joi.string().min(3).max(30).required().error(function (errors) {\n    errors.forEach(function (err) {\n      switch (err.type) {\n        case \"any.empty\":\n          err.message = \"＊ユーザー名は必須です\";\n          break;\n\n        case \"string.min\":\n          err.message = \"\\uFF0A\\u30E6\\u30FC\\u30B6\\u30FC\\u540D\\u306F\".concat(err.context.limit, \"\\u6587\\u5B57\\u4EE5\\u4E0A\\u3067\\u8A2D\\u5B9A\\u3057\\u3066\\u304F\\u3060\\u3055\\u3044\");\n          break;\n\n        case \"string.max\":\n          err.message = \"\\uFF0A\\u30E6\\u30FC\\u30B6\\u30FC\\u540D\\u306F\".concat(err.context.limit, \"\\u6587\\u5B57\\u4EE5\\u5185\\u3067\\u8A2D\\u5B9A\\u3057\\u3066\\u304F\\u3060\\u3055\\u3044\");\n          break;\n\n        default:\n          break;\n      }\n    });\n    return new Error(errors);\n  }),\n  password: Joi.string().min(6).required().error(function (errors) {\n    errors.forEach(function (err) {\n      switch (err.type) {\n        case \"any.empty\":\n          err.message = \"＊パスワードは必須です\";\n          break;\n\n        case \"string.min\":\n          err.message = \"\\uFF0A\\u30D1\\u30B9\\u30EF\\u30FC\\u30C9\\u306F\".concat(err.context.limit, \"\\u6587\\u5B57\\u4EE5\\u4E0A\\u3067\\u8A2D\\u5B9A\\u3057\\u3066\\u304F\\u3060\\u3055\\u3044\");\n          break;\n\n        case \"string.max\":\n          err.message = \"\\uFF0A\\u30D1\\u30B9\\u30EF\\u30FC\\u30C9\\u306F\".concat(err.context.limit, \"\\u6587\\u5B57\\u4EE5\\u5185\\u3067\\u8A2D\\u5B9A\\u3057\\u3066\\u304F\\u3060\\u3055\\u3044\");\n          break;\n\n        default:\n          break;\n      }\n    });\n    return new Error(errors);\n  }),\n  confirm_password: Joi.string().required().valid(Joi.ref(\"password\")).error(function (errors) {\n    errors.forEach(function (err) {\n      switch (err.type) {\n        case \"any.empty\":\n          err.message = \"＊確認用パスワードは必須です\";\n          break;\n\n        case \"any.allowOnly\":\n          err.message = \"\\uFF0A\\u78BA\\u8A8D\\u7528\\u30D1\\u30B9\\u30EF\\u30FC\\u30C9\\u304C\\u4E00\\u81F4\\u3057\\u3066\\u3044\\u307E\\u305B\\u3093\";\n          break;\n\n        default:\n          break;\n      }\n    });\n    return new Error(errors);\n  })\n});\n\nvar Register = function Register(props) {\n  _s();\n\n  var _useState = useState({\n    'user_name': '',\n    'password': '',\n    'confirm_password': ''\n  }),\n      _useState2 = _slicedToArray(_useState, 2),\n      formData = _useState2[0],\n      setFormData = _useState2[1];\n\n  var _useState3 = useState([]),\n      _useState4 = _slicedToArray(_useState3, 2),\n      errorMessages = _useState4[0],\n      setValidationMessages = _useState4[1];\n\n  var history = useHistory();\n\n  var onChangeEvent = function onChangeEvent(e) {\n    var name = e.target.name;\n    setFormData(_objectSpread(_objectSpread({}, formData), {}, _defineProperty({}, name, e.target.value)));\n  }; // 送信処理\n\n\n  var handleSubmit = function handleSubmit(e) {\n    var validationCheckFlag = false; // from入力の動作を制御\n\n    e.preventDefault(); // バリデーション実行\n\n    var _schema$validate = schema.validate(formData, {\n      abortEarly: false\n    }),\n        error = _schema$validate.error;\n\n    if (error) {\n      var messages = error.message.split(',');\n      setValidationMessages(messages);\n      return false;\n    } else {\n      validationCheckFlag = true;\n    }\n\n    if (validationCheckFlag) {\n      axios.post('http://localhost:80/api/register', formData).then(function (res) {\n        history.push('/login');\n      }).catch(function (error) {\n        // エラーメッセージの配列を用意\n        var messages = []; // レスポンスをオブジェクトから配列に変換\n\n        var arr = Object.entries(error.response.data.errors); // レスポンスの配列からメッセージだけを取り出し、エラーメッセージの配列にセット\n\n        arr.forEach(function (value) {\n          messages.push(value[1][0]);\n        }); // 表示用の配列にセット\n\n        setValidationMessages(messages);\n      });\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: /*#__PURE__*/_jsxDEV(RegisterSection, {\n      className: \"h-screen bg-main flex items-center justify-center\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bg-main flex justify-between items-center fixed top-0 z-50 h-12 w-full px-4\",\n        children: /*#__PURE__*/_jsxDEV(Link, {\n          className: \"inline-block\",\n          to: \"/\",\n          children: /*#__PURE__*/_jsxDEV(\"img\", {\n            src: Left,\n            width: \"28\",\n            height: \"28\",\n            alt: \"\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 139,\n            columnNumber: 13\n          }, _this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 138,\n          columnNumber: 11\n        }, _this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 137,\n        columnNumber: 9\n      }, _this), /*#__PURE__*/_jsxDEV(Content, {\n        className: \"w-80 py-10\",\n        children: [/*#__PURE__*/_jsxDEV(Tiltle, {\n          className: \"text-center mb-5 text-3xl\",\n          children: \"\\u65B0\\u898F\\u767B\\u9332\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 143,\n          columnNumber: 11\n        }, _this), /*#__PURE__*/_jsxDEV(\"ul\", {\n          className: \"mx-auto px-5 text-red-600\",\n          children: errorMessages.map(function (item, index) {\n            return /*#__PURE__*/_jsxDEV(\"li\", {\n              children: item\n            }, index, false, {\n              fileName: _jsxFileName,\n              lineNumber: 148,\n              columnNumber: 19\n            }, _this);\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 144,\n          columnNumber: 11\n        }, _this), /*#__PURE__*/_jsxDEV(\"form\", {\n          onSubmit: handleSubmit,\n          className: \"login-wrap w-full mx-auto py-6 tracking-widest\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex justify-center mb-2\",\n            children: [/*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"bg-main w-10 h-10 p-1\",\n              children: /*#__PURE__*/_jsxDEV(\"img\", {\n                src: Ninja,\n                alt: \"\\u30A2\\u30A4\\u30B3\\u30F3\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 156,\n                columnNumber: 19\n              }, _this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 155,\n              columnNumber: 17\n            }, _this), /*#__PURE__*/_jsxDEV(InputText, {\n              name: 'user_name',\n              styled: 'w-9/12 p-1',\n              type: \"text\",\n              placeholder: 'ユーザー名',\n              onChange: onChangeEvent\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 158,\n              columnNumber: 17\n            }, _this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 154,\n            columnNumber: 15\n          }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex justify-center mb-2\",\n            children: [/*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"bg-main w-10 h-10 p-1\",\n              children: /*#__PURE__*/_jsxDEV(\"img\", {\n                src: Key,\n                alt: \"\\u30A2\\u30A4\\u30B3\\u30F3\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 162,\n                columnNumber: 19\n              }, _this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 161,\n              columnNumber: 17\n            }, _this), /*#__PURE__*/_jsxDEV(InputText, {\n              name: 'password',\n              styled: 'w-9/12 p-1',\n              type: \"password\",\n              placeholder: 'パスワード',\n              onChange: onChangeEvent\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 164,\n              columnNumber: 17\n            }, _this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 160,\n            columnNumber: 15\n          }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex justify-center mb-4\",\n            children: [/*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"bg-main w-10 h-10 p-1\",\n              children: /*#__PURE__*/_jsxDEV(\"img\", {\n                src: Key,\n                alt: \"\\u30A2\\u30A4\\u30B3\\u30F3\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 168,\n                columnNumber: 19\n              }, _this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 167,\n              columnNumber: 17\n            }, _this), /*#__PURE__*/_jsxDEV(InputText, {\n              name: 'confirm_password',\n              styled: 'w-9/12 p-1',\n              type: \"password\",\n              placeholder: '確認用パスワード',\n              onChange: onChangeEvent\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 170,\n              columnNumber: 17\n            }, _this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 166,\n            columnNumber: 15\n          }, _this), /*#__PURE__*/_jsxDEV(InputButton, {\n            children: \"\\u767B\\u9332\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 172,\n            columnNumber: 13\n          }, _this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 153,\n          columnNumber: 11\n        }, _this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 142,\n        columnNumber: 9\n      }, _this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 136,\n      columnNumber: 7\n    }, _this)\n  }, void 0, false);\n};\n\n_s(Register, \"T8Ro5SkMgu930xGxec30Ai3Z0z4=\", false, function () {\n  return [useHistory];\n});\n\n_c = Register;\nvar RegisterSection = styled.section(_templateObject || (_templateObject = _taggedTemplateLiteral([\"\\n  .primary-input{\\n    text-align:left;\\n  }\\n\"])));\n_c2 = RegisterSection;\nvar Content = styled.div(_templateObject2 || (_templateObject2 = _taggedTemplateLiteral([\"\\n  background: #E8D1F0;\\n\"])));\n_c3 = Content;\nvar Tiltle = styled.h2(_templateObject3 || (_templateObject3 = _taggedTemplateLiteral([\"\\n  color: #000;\\n\"])));\n_c4 = Tiltle;\nexport default Register;\n\nvar _c, _c2, _c3, _c4;\n\n$RefreshReg$(_c, \"Register\");\n$RefreshReg$(_c2, \"RegisterSection\");\n$RefreshReg$(_c3, \"Content\");\n$RefreshReg$(_c4, \"Tiltle\");","map":{"version":3,"sources":["/usr/src/app/src/pages/Register.jsx"],"names":["useState","useHistory","styled","axios","InputText","InputButton","Link","Joi","schema","object","user_name","string","min","max","required","error","errors","forEach","err","type","message","context","limit","Error","password","confirm_password","valid","ref","Register","props","formData","setFormData","errorMessages","setValidationMessages","history","onChangeEvent","e","name","target","value","handleSubmit","validationCheckFlag","preventDefault","validate","abortEarly","messages","split","post","then","res","push","catch","arr","Object","entries","response","data","Left","map","item","index","Ninja","Key","RegisterSection","section","Content","div","Tiltle","h2"],"mappings":"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","sourcesContent":["import { useState } from 'react'\nimport { useHistory } from 'react-router-dom';\nimport styled from 'styled-components'\nimport axios from 'axios'\nimport {\n  InputText,\n  InputButton\n} from '../components/index'\nimport Ninja from '../images/ninja.svg'\nimport Key from '../images/key.svg'\nimport { Link } from 'react-router-dom'\nimport Left from '../images/left-arrow.svg'\nimport Joi from 'joi-browser';\n\nconst schema = Joi.object({\n  user_name: Joi.string()\n    .min(3)\n    .max(30)\n    .required()\n    .error(errors => {\n      errors.forEach(err => {\n        switch (err.type) {\n          case \"any.empty\":\n            err.message = \"＊ユーザー名は必須です\";\n            break;\n          case \"string.min\":\n            err.message = `＊ユーザー名は${err.context.limit}文字以上で設定してください`;\n            break;\n          case \"string.max\":\n            err.message = `＊ユーザー名は${err.context.limit}文字以内で設定してください`;\n            break;\n          default:\n            break;\n        }\n      });\n      return new Error(errors);\n    }),\n\n  password: Joi.string()\n    .min(6)\n    .required()\n    .error(errors => {\n      errors.forEach(err => {\n        switch (err.type) {\n          case \"any.empty\":\n            err.message = \"＊パスワードは必須です\";\n            break;\n          case \"string.min\":\n            err.message = `＊パスワードは${err.context.limit}文字以上で設定してください`;\n            break;\n          case \"string.max\":\n            err.message = `＊パスワードは${err.context.limit}文字以内で設定してください`;\n            break;\n          default:\n            break;\n        }\n      });\n      return new Error(errors);\n    }),\n\n  confirm_password: Joi.string()\n    .required()\n    .valid(Joi.ref(\"password\"))\n    .error(errors => {\n      errors.forEach(err => {\n        switch (err.type) {\n          case \"any.empty\":\n            err.message = \"＊確認用パスワードは必須です\";\n            break;\n          case \"any.allowOnly\":\n            err.message = `＊確認用パスワードが一致していません`;\n            break;\n          default:\n            break;\n        }\n      });\n      return new Error(errors);\n    }),\n})\n\nconst Register = (props) => {\n  const [formData, setFormData] = useState({\n    'user_name' : '',\n    'password' : '',\n    'confirm_password' : '',\n  })\n  const [errorMessages, setValidationMessages] = useState([])\n  const history = useHistory()\n\n  const onChangeEvent = (e) => {\n    const name = e.target.name;\n    setFormData({\n      ...formData,\n      [name]: e.target.value\n    });\n  }\n\n  // 送信処理\n  const handleSubmit = (e) => {\n    let validationCheckFlag = false;\n    // from入力の動作を制御\n    e.preventDefault();\n\n    // バリデーション実行\n    const { error } = schema.validate(formData, {abortEarly: false});\n\n    if(error) {\n      let messages = error.message.split(',');\n      setValidationMessages(messages);\n      return false;\n    } else {\n      validationCheckFlag = true;\n    }\n\n    if(validationCheckFlag) {\n      axios.post('http://localhost:80/api/register', formData)\n      .then(res => {\n        history.push('/login');\n      }).catch((error) => {\n        // エラーメッセージの配列を用意\n        let messages = [];\n        // レスポンスをオブジェクトから配列に変換\n        let arr = Object.entries(error.response.data.errors);\n        // レスポンスの配列からメッセージだけを取り出し、エラーメッセージの配列にセット\n        arr.forEach(function (value) {\n          messages.push(value[1][0]);\n        })\n        // 表示用の配列にセット\n        setValidationMessages(messages);\n      })  \n    }\n  }\n\n  return (\n    <>\n      <RegisterSection className=\"h-screen bg-main flex items-center justify-center\">\n        <div className=\"bg-main flex justify-between items-center fixed top-0 z-50 h-12 w-full px-4\">\n          <Link className=\"inline-block\" to=\"/\">\n            <img src={ Left } width=\"28\" height=\"28\" alt=\"\" />\n          </Link>\n        </div>\n        <Content className=\"w-80 py-10\">\n          <Tiltle className=\"text-center mb-5 text-3xl\">新規登録</Tiltle>\n          <ul className=\"mx-auto px-5 text-red-600\">\n            {\n            errorMessages.map((item, index) => {\n              return (\n                  <li key={ index }>{ item }</li>\n                  )\n                })\n            }\n          </ul>\n          <form onSubmit={ handleSubmit } className=\"login-wrap w-full mx-auto py-6 tracking-widest\"> \n              <div className=\"flex justify-center mb-2\">\n                <p className=\"bg-main w-10 h-10 p-1\" >\n                  <img src={ Ninja }  alt=\"アイコン\" />\n                </p>\n                <InputText name={ 'user_name' } styled={ 'w-9/12 p-1' } type=\"text\" placeholder={ 'ユーザー名' } onChange={ onChangeEvent } />\n              </div>\n              <div className=\"flex justify-center mb-2\">\n                <p className=\"bg-main w-10 h-10 p-1\" >\n                  <img src={ Key }  alt=\"アイコン\" />\n                </p>\n                <InputText name={ 'password' } styled={ 'w-9/12 p-1' } type=\"password\" placeholder={ 'パスワード' } onChange={ onChangeEvent } />\n              </div>\n              <div className=\"flex justify-center mb-4\">\n                <p className=\"bg-main w-10 h-10 p-1\" >\n                  <img src={ Key }  alt=\"アイコン\" />\n                </p>\n                <InputText name={ 'confirm_password' } styled={ 'w-9/12 p-1' } type=\"password\" placeholder={ '確認用パスワード' } onChange={ onChangeEvent } />\n              </div>\n            <InputButton >登録</InputButton>\n          </form>\n        </Content>\n      </RegisterSection>\n    </>\n  )\n}\n\nconst RegisterSection = styled.section`\n  .primary-input{\n    text-align:left;\n  }\n`\nconst Content = styled.div`\n  background: #E8D1F0;\n`\nconst Tiltle = styled.h2`\n  color: #000;\n`\n\nexport default Register\n"]},"metadata":{},"sourceType":"module"}