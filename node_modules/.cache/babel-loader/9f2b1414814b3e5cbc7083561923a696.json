{"ast":null,"code":"import _taggedTemplateLiteral from \"/usr/src/app/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral.js\";\nimport _slicedToArray from \"/usr/src/app/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\n\nvar _jsxFileName = \"/usr/src/app/src/pages/PostDetail.jsx\",\n    _this = this,\n    _s = $RefreshSig$(),\n    _templateObject,\n    _templateObject2;\n\nimport { useState, useEffect } from \"react\";\nimport axios from 'axios';\nimport styled from \"styled-components\";\nimport { PrimaryButton, Footer, HeaderBackButton } from '../components/index';\nimport DefaultIcon from '../images/default-icon.png';\nimport { Link } from 'react-router-dom';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar PostDetail = function PostDetail(props) {\n  _s();\n\n  // ログイン機能が完了したらログインしているユーザーのIDを取得\n  var loginedUserId = Number(localStorage.getItem('userId'));\n\n  var _useState = useState([]),\n      _useState2 = _slicedToArray(_useState, 2),\n      groupData = _useState2[0],\n      setGroupData = _useState2[1]; // オブジェクトになっているせいなのか、groupDataからmst_gameのゲーム名が取得できず、仕方なくゲーム名用の変数作成\n  // API呼び出し時にresponseから直接参照すると取得できるので、その際にこのgameNameにセットしている\n  // よく分からないので、とりあえずこの方法で対応\n\n\n  var _useState3 = useState(''),\n      _useState4 = _slicedToArray(_useState3, 2),\n      gameName = _useState4[0],\n      setGameName = _useState4[1];\n\n  var _useState5 = useState(''),\n      _useState6 = _slicedToArray(_useState5, 2),\n      styleName = _useState6[0],\n      setStyleName = _useState6[1];\n\n  var _useState7 = useState([]),\n      _useState8 = _slicedToArray(_useState7, 2),\n      groupMember = _useState8[0],\n      setGroupMember = _useState8[1];\n\n  var _useState9 = useState([]),\n      _useState10 = _slicedToArray(_useState9, 2),\n      postData = _useState10[0],\n      setPostData = _useState10[1];\n\n  var groupId = props.match.params.id;\n\n  var _useState11 = useState(false),\n      _useState12 = _slicedToArray(_useState11, 2),\n      groupMemberCheckFlag = _useState12[0],\n      setGroupMemberCheckFlag = _useState12[1];\n\n  var _useState13 = useState(false),\n      _useState14 = _slicedToArray(_useState13, 2),\n      joinRequestedFlag = _useState14[0],\n      setJoinRequestedFlag = _useState14[1];\n\n  useEffect(function () {\n    getGroup(groupId);\n    getGroupMember(groupId, loginedUserId, checkGroupMember);\n    getPost(groupId, loginedUserId, checkJoinRequested);\n  }, [groupId, loginedUserId]);\n\n  var getGroup = function getGroup(id) {\n    var url = process.env.REACT_APP_BACKEND_PATH;\n    axios.get(url + '/api/groups/groupid/' + id).then(function (res) {\n      setGroupData(res.data.results);\n      setGameName(res.data.results.mst_game.game_name);\n      setStyleName(res.data.results.mst_style.style_name);\n    }).catch(function (error) {\n      console.log(error);\n    });\n  };\n\n  var getGroupMember = function getGroupMember(id, userId, checkGroupMember) {\n    var url = process.env.REACT_APP_BACKEND_PATH;\n    axios.get(url + '/api/group/member/' + id).then(function (res) {\n      setGroupMember(res.data.results);\n      checkGroupMember(res.data.results, userId);\n    }).catch(function (error) {\n      console.log(error);\n    });\n  };\n\n  var _useState15 = useState(\"hidden\"),\n      _useState16 = _slicedToArray(_useState15, 2),\n      styledHidden = _useState16[0],\n      setStyledHidden = _useState16[1];\n\n  var onClickToggle = function onClickToggle() {\n    setStyledHidden(!styledHidden ? \"hidden\" : \"\");\n  };\n\n  var getPost = function getPost(groupId, userId, checkJoinRequested) {\n    var url = process.env.REACT_APP_BACKEND_PATH;\n    axios.get(url + '/api/post/' + groupId).then(function (res) {\n      setPostData(res.data.results);\n      checkJoinRequested(userId, res.data.results.id);\n    }).catch(function (error) {\n      console.log(error);\n    });\n  };\n\n  var checkGroupMember = function checkGroupMember(member, usertId) {\n    member.forEach(function (item) {\n      if (Number(item.user_id) === usertId) {\n        setGroupMemberCheckFlag(true);\n      }\n    });\n  };\n\n  var sendJoinRequest = function sendJoinRequest() {\n    var url = process.env.REACT_APP_BACKEND_PATH;\n    setJoinRequestedFlag(true);\n    axios.post(url + '/api/subscriptions', {\n      user_id: loginedUserId,\n      post_id: postData.id,\n      leader_id: groupData.leader_id\n    }).then(function (res) {}).catch(function (error) {\n      console.log(error);\n    });\n  };\n\n  var checkJoinRequested = function checkJoinRequested(userId, postId) {\n    var url = process.env.REACT_APP_BACKEND_PATH;\n    axios.get(url + '/api/subscriptions/' + userId + '/' + postId).then(function (res) {\n      if (res.data.results !== null) {\n        setJoinRequestedFlag(true);\n      }\n    }).catch(function (error) {\n      console.log(error);\n    });\n  };\n\n  return /*#__PURE__*/_jsxDEV(GroupDetailWrap, {\n    className: \"h-screen bg-sub py-16\",\n    children: [/*#__PURE__*/_jsxDEV(HeaderBackButton, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 7\n    }, _this), /*#__PURE__*/_jsxDEV(PostItem, {\n      className: \"psot-item w-80 bg-white px-5 pb-2 pt-6 mb-10 m-auto\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex mb-5\",\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"profile-logo\",\n          children: /*#__PURE__*/_jsxDEV(\"img\", {\n            className: \"rounded-full\",\n            src: groupData.icon === null ? DefaultIcon : groupData.icon,\n            alt: \"\\u30D7\\u30ED\\u30D5\\u30A3\\u30FC\\u30EB\\u753B\\u50CF\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 124,\n            columnNumber: 39\n          }, _this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 124,\n          columnNumber: 11\n        }, _this), /*#__PURE__*/_jsxDEV(\"h3\", {\n          className: \"post-team-name text-2xl ml-3 pt-4 break-all w-6.5/10\",\n          children: groupData.group_name\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 125,\n          columnNumber: 11\n        }, _this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 123,\n        columnNumber: 9\n      }, _this), /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"post-list-item truncate\",\n        children: gameName\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 127,\n        columnNumber: 9\n      }, _this), /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"post-list-item\",\n        children: [\"\\u30B9\\u30BF\\u30A4\\u30EB:\", /*#__PURE__*/_jsxDEV(\"span\", {\n          children: styleName\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 128,\n          columnNumber: 44\n        }, _this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 128,\n        columnNumber: 9\n      }, _this), /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"post-list-item\",\n        children: [\"\\u52DF\\u96C6\\u4EBA\\u6570:\", /*#__PURE__*/_jsxDEV(\"span\", {\n          children: groupData.recruitment\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 129,\n          columnNumber: 44\n        }, _this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 129,\n        columnNumber: 9\n      }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex justify-between mb-4\",\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"post-list-item\",\n          children: [\"\\u53C2\\u52A0\\u4EBA\\u6570:\", /*#__PURE__*/_jsxDEV(\"span\", {\n            children: groupData.participants\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 131,\n            columnNumber: 46\n          }, _this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 131,\n          columnNumber: 11\n        }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n          onClick: onClickToggle,\n          className: groupMember[0] ? \"\" : \"hidden\",\n          children: /*#__PURE__*/_jsxDEV(PrimaryButton, {\n            styles: \"bg-sub tex p-1 text-xs\",\n            children: \"\\u30E1\\u30F3\\u30D0\\u30FC\\u4E00\\u89A7\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 133,\n            columnNumber: 13\n          }, _this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 132,\n          columnNumber: 11\n        }, _this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 130,\n        columnNumber: 9\n      }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: styledHidden,\n        children: /*#__PURE__*/_jsxDEV(\"ul\", {\n          className: \"friend-list mb-8\",\n          children: groupMember.map(function (data, index) {\n            return /*#__PURE__*/_jsxDEV(\"li\", {\n              className: \"flex items-center mb-3\",\n              children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"firend-logo\",\n                children: /*#__PURE__*/_jsxDEV(\"img\", {\n                  className: \"rounded-full\",\n                  src: data.user.icon === null ? DefaultIcon : data.user.icon,\n                  alt: \"\\u30D7\\u30ED\\u30D5\\u30A3\\u30FC\\u30EB\\u753B\\u50CF\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 142,\n                  columnNumber: 48\n                }, _this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 142,\n                columnNumber: 21\n              }, _this), /*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"ml-2\",\n                children: data.user.user_name\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 143,\n                columnNumber: 21\n              }, _this)]\n            }, index, true, {\n              fileName: _jsxFileName,\n              lineNumber: 141,\n              columnNumber: 19\n            }, _this);\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 137,\n          columnNumber: 11\n        }, _this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 136,\n        columnNumber: 9\n      }, _this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"\\u30B0\\u30EB\\u30FC\\u30D7\\u8A73\\u7D30\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 150,\n        columnNumber: 9\n      }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"post-detail\",\n        children: /*#__PURE__*/_jsxDEV(\"p\", {\n          children: groupData.description\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 152,\n          columnNumber: 11\n        }, _this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 151,\n        columnNumber: 9\n      }, _this), function () {\n        var html = '';\n\n        if (groupMemberCheckFlag) {\n          html = /*#__PURE__*/_jsxDEV(Link, {\n            to: '/group/detail/' + groupData.id,\n            children: /*#__PURE__*/_jsxDEV(PrimaryButton, {\n              styles: \"bg-sub py-1 px-7 py-2 text-sm m-auto\",\n              children: \"\\u30B0\\u30EB\\u30FC\\u30D7\\u3078\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 162,\n              columnNumber: 19\n            }, _this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 161,\n            columnNumber: 17\n          }, _this);\n        } else {\n          if (joinRequestedFlag) {\n            html = /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex items-center\",\n              children: /*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"inline-block text-black text-opacity-25 bg-sub px-7 py-2 text-sm m-auto\",\n                children: \"\\u5FDC\\u52DF\\u3059\\u308B\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 169,\n                columnNumber: 21\n              }, _this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 168,\n              columnNumber: 19\n            }, _this);\n          } else {\n            html = /*#__PURE__*/_jsxDEV(PrimaryButton, {\n              styles: 'bg-sub py-1 px-7 py-2 text-sm m-auto',\n              onClick: sendJoinRequest,\n              children: \"\\u5FDC\\u52DF\\u3059\\u308B\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 176,\n              columnNumber: 19\n            }, _this);\n          }\n        }\n\n        return html;\n      }()]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 122,\n      columnNumber: 7\n    }, _this), /*#__PURE__*/_jsxDEV(Footer, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 184,\n      columnNumber: 7\n    }, _this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 120,\n    columnNumber: 5\n  }, _this);\n};\n\n_s(PostDetail, \"sRYKA/e3waFYhcH2J1gzC4zZfPU=\");\n\n_c = PostDetail;\nvar GroupDetailWrap = styled.section(_templateObject || (_templateObject = _taggedTemplateLiteral([\"\\n  \\n\"])));\n_c2 = GroupDetailWrap;\nvar PostItem = styled.div(_templateObject2 || (_templateObject2 = _taggedTemplateLiteral([\"\\n  position: relative;\\n  .profile-logo img{\\n    width: 65px;\\n    height: 65px;\\n  }\\n  .firend-logo img{\\n    width: 40px;\\n    height: 40px;\\n  }\\n  .post-list-item span{\\n    margin:0 0 0 10px;\\n  }\\n  .post-detail{\\n    width: 100%;\\n    margin: 0 0 18px 0;\\n    padding: 0 3px;\\n    border:solid 1px #000;\\n    overflow: hidden;\\n  }\\n  .primary-button{\\n    \\n    color:#fff;\\n  }\\n\"])));\n_c3 = PostItem;\nexport default PostDetail;\n\nvar _c, _c2, _c3;\n\n$RefreshReg$(_c, \"PostDetail\");\n$RefreshReg$(_c2, \"GroupDetailWrap\");\n$RefreshReg$(_c3, \"PostItem\");","map":{"version":3,"sources":["/usr/src/app/src/pages/PostDetail.jsx"],"names":["useState","useEffect","axios","styled","PrimaryButton","Footer","HeaderBackButton","DefaultIcon","Link","PostDetail","props","loginedUserId","Number","localStorage","getItem","groupData","setGroupData","gameName","setGameName","styleName","setStyleName","groupMember","setGroupMember","postData","setPostData","groupId","match","params","id","groupMemberCheckFlag","setGroupMemberCheckFlag","joinRequestedFlag","setJoinRequestedFlag","getGroup","getGroupMember","checkGroupMember","getPost","checkJoinRequested","url","process","env","REACT_APP_BACKEND_PATH","get","then","res","data","results","mst_game","game_name","mst_style","style_name","catch","error","console","log","userId","styledHidden","setStyledHidden","onClickToggle","member","usertId","forEach","item","user_id","sendJoinRequest","post","post_id","leader_id","postId","icon","group_name","recruitment","participants","map","index","user","user_name","description","html","GroupDetailWrap","section","PostItem","div"],"mappings":"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","sourcesContent":["import { useState, useEffect } from \"react\";\nimport axios from 'axios';\nimport styled from \"styled-components\";\nimport {\n  PrimaryButton,\n  Footer,\n  HeaderBackButton\n} from '../components/index';\nimport DefaultIcon from '../images/default-icon.png'\nimport { Link } from 'react-router-dom';\n\nconst PostDetail = (props) => {\n  // ログイン機能が完了したらログインしているユーザーのIDを取得\n  const loginedUserId = Number(localStorage.getItem('userId'));\n  const [groupData, setGroupData] = useState([]);\n  // オブジェクトになっているせいなのか、groupDataからmst_gameのゲーム名が取得できず、仕方なくゲーム名用の変数作成\n  // API呼び出し時にresponseから直接参照すると取得できるので、その際にこのgameNameにセットしている\n  // よく分からないので、とりあえずこの方法で対応\n  const [gameName, setGameName] = useState('');\n  const [styleName, setStyleName] = useState('');\n  const [groupMember, setGroupMember] = useState([]);\n  const [postData, setPostData] = useState([]);\n  const groupId = props.match.params.id;\n  const [groupMemberCheckFlag, setGroupMemberCheckFlag] = useState(false);\n  const [joinRequestedFlag, setJoinRequestedFlag] = useState(false);\n\n  useEffect(() => {\n    getGroup(groupId);\n    getGroupMember(groupId, loginedUserId, checkGroupMember);\n    getPost(groupId, loginedUserId, checkJoinRequested);\n  },[groupId, loginedUserId])\n\n  const getGroup = (id) => {\n    let url = process.env.REACT_APP_BACKEND_PATH;\n\n    axios.get(url + '/api/groups/groupid/' + id)\n    .then((res) => {\n      setGroupData(res.data.results);\n      setGameName(res.data.results.mst_game.game_name);\n      setStyleName(res.data.results.mst_style.style_name);\n    })\n    .catch((error) => {\n      console.log(error);\n    })\n  }\n\n  const getGroupMember = (id, userId, checkGroupMember) => {\n    let url = process.env.REACT_APP_BACKEND_PATH;\n\n    axios.get(url + '/api/group/member/' + id)\n    .then((res) => {\n      setGroupMember(res.data.results);\n      checkGroupMember(res.data.results, userId);\n    })\n    .catch((error) => {\n      console.log(error);\n    })\n  }\n\n  const [styledHidden, setStyledHidden] = useState(\"hidden\");\n  \n  const onClickToggle = () => {\n    setStyledHidden(!styledHidden　? \"hidden\" : \"\" );\n  }\n\n  const getPost = (groupId, userId, checkJoinRequested) => {\n    let url = process.env.REACT_APP_BACKEND_PATH;\n\n    axios.get(url + '/api/post/' + groupId)\n    .then((res) => {\n      setPostData(res.data.results);\n      checkJoinRequested(userId, res.data.results.id)\n    })\n    .catch((error) => {\n      console.log(error);\n    })\n  }\n\n  const checkGroupMember = (member, usertId) => {\n    member.forEach(item => {\n      if(Number(item.user_id) === usertId) {\n        setGroupMemberCheckFlag(true);\n      }\n    })\n  }\n\n  const sendJoinRequest = () => {\n    let url = process.env.REACT_APP_BACKEND_PATH;\n\n    setJoinRequestedFlag(true)\n\n    axios.post(url + '/api/subscriptions', {\n      user_id : loginedUserId,\n      post_id : postData.id,\n      leader_id : groupData.leader_id,\n    })\n    .then((res) => {\n      \n    })\n    .catch((error) => {\n      console.log(error);\n    })\n  }\n\n  const checkJoinRequested = (userId, postId) => {\n    let url = process.env.REACT_APP_BACKEND_PATH;\n\n    axios.get(url + '/api/subscriptions/' + userId + '/' + postId)\n    .then((res) => {\n      if(res.data.results !== null) {\n        setJoinRequestedFlag(true)\n      }\n    })\n    .catch((error) => {\n      console.log(error);\n    })\n  }\n\n  return (\n    <GroupDetailWrap className=\"h-screen bg-sub py-16\">\n      <HeaderBackButton />\n      <PostItem className=\"psot-item w-80 bg-white px-5 pb-2 pt-6 mb-10 m-auto\">\n        <div className=\"flex mb-5\">\n          <p className=\"profile-logo\"><img className=\"rounded-full\" src={ groupData.icon === null ? DefaultIcon : groupData.icon } alt=\"プロフィール画像\" /></p>\n          <h3 className=\"post-team-name text-2xl ml-3 pt-4 break-all w-6.5/10\">{ groupData.group_name }</h3>\n        </div>\n        <p className=\"post-list-item truncate\">{ gameName }</p>\n        <p className=\"post-list-item\">スタイル:<span>{ styleName }</span></p>\n        <p className=\"post-list-item\">募集人数:<span>{ groupData.recruitment }</span></p>\n        <div className=\"flex justify-between mb-4\">\n          <p className=\"post-list-item\">参加人数:<span>{ groupData.participants }</span></p>\n          <div onClick={ onClickToggle } className={ groupMember[0] ? \"\" : \"hidden\" }>\n            <PrimaryButton styles={ \"bg-sub tex p-1 text-xs\" }>メンバー一覧</PrimaryButton>\n          </div>\n        </div>\n        <div className={ styledHidden }>\n          <ul className=\"friend-list mb-8\">\n            {\n              groupMember.map((data, index) => {\n                return (\n                  <li key={index} className=\"flex items-center mb-3\">\n                    <p className=\"firend-logo\"><img className=\"rounded-full\" src={ data.user.icon === null ? DefaultIcon : data.user.icon } alt=\"プロフィール画像\" /></p>\n                    <p className=\"ml-2\">{ data.user.user_name }</p>\n                  </li>\n                )\n              })\n            }\n          </ul>\n        </div>\n        <p>グループ詳細</p>\n        <div className=\"post-detail\">\n          <p>\n            { groupData.description }\n          </p>\n        </div>\n        {(\n          () => {\n            let html = ''\n            if(groupMemberCheckFlag) {\n              html = (\n                <Link to={'/group/detail/' + groupData.id}>            \n                  <PrimaryButton styles={\"bg-sub py-1 px-7 py-2 text-sm m-auto\"}>グループへ</PrimaryButton>\n                </Link>\n              )\n            } else {\n              if(joinRequestedFlag) {\n                html = (\n                  <div className=\"flex items-center\">\n                    <p className=\"inline-block text-black text-opacity-25 bg-sub px-7 py-2 text-sm m-auto\">\n                      応募する\n                    </p>\n                  </div>\n                )\n              } else {\n                html = (\n                  <PrimaryButton styles={'bg-sub py-1 px-7 py-2 text-sm m-auto'} onClick={ sendJoinRequest }>応募する</PrimaryButton>\n                )\n              }\n            }\n            return html;\n          }\n        )()}\n      </PostItem>\n      <Footer />\n    </GroupDetailWrap>\n  )\n}\n\nconst GroupDetailWrap = styled.section`\n  \n`\nconst PostItem = styled.div`\n  position: relative;\n  .profile-logo img{\n    width: 65px;\n    height: 65px;\n  }\n  .firend-logo img{\n    width: 40px;\n    height: 40px;\n  }\n  .post-list-item span{\n    margin:0 0 0 10px;\n  }\n  .post-detail{\n    width: 100%;\n    margin: 0 0 18px 0;\n    padding: 0 3px;\n    border:solid 1px #000;\n    overflow: hidden;\n  }\n  .primary-button{\n    \n    color:#fff;\n  }\n`\n\nexport default PostDetail"]},"metadata":{},"sourceType":"module"}